<h2>BFF OpenIddict Security architecture with Angular nx</h2>

@if (userProfileClaims$ | async; as userProfileClaims) {
  @if (userProfileClaims?.isAuthenticated) {
    <div>
      <button (click)="getDirectApiData()">get data from API direct</button>
      <button (click)="getDownstreamApiData()">
        get downstream data using API Cert Auth
      </button>
      <form method="post" action="api/Account/Logout">
        <button class="btn btn-link" type="submit">Sign out</button>
      </form>
    </div>
  } @else {
    <a class="btn btn-link" href="api/Account/Login">Log in</a>
  }
  <hr />
  <h2>User profile:</h2>
  <pre>{{ userProfileClaims | json }}</pre>
  <hr />
  <h2>get direct data using API:</h2>
  <pre>{{ dataFromAzureProtectedApi$ | async | json }}</pre>
  <h2>get downstream data using API Cert Auth:</h2>
  <pre>{{ downstreamApiData$ | async | json }}</pre>
} @else {
  <a class="btn btn-link" href="api/Account/Login">Log in</a>
}

